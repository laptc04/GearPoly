<!doctype html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">

<head>
	<title>Thông tin người dùng</title>
	<!-- Required meta tags -->
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

	<!-- Bootstrap CSS v5.2.1 -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous" />
	<link rel="stylesheet" href="css/button.css">
	<link rel="stylesheet" href="css/quanlyvideo.css">
</head>
<style>
	h2 {
		font-size: 72px;
		background: -webkit-linear-gradient(#dd93e0, #333);
		-webkit-background-clip: text;
		-webkit-text-fill-color: transparent;
	}

	#h2 {
		font-size: 50px;
		background: -webkit-linear-gradient(#dd93e0, #333);
		-webkit-background-clip: text;
		-webkit-text-fill-color: transparent;
	}

	input {
		height: 40px;
		border: none;
		background-color: rgba(171, 177, 181, 0.205);
		width: 400px;
	}

	h3 {
		font-family: "open sans", "sans-serif";
	}

	.to {
		background-color: rgba(240, 248, 255, 0.21);
	}

	.anh {
		border: 5px;

	}

	#nut {

		height: 40px;
		width: 60px;


	}

	#divnut {
		display: inline-block;
		justify-content: center;
		text-align: center;

	}

	::-webkit-scrollbar {
		width: 15px;
	}

	::-webkit-scrollbar-track {
		background: #d1e5ff;
	}

	::-webkit-scrollbar-thumb {
		background: linear-gradient(#642bff, #ff22e6);
		border-radius: 10px;
	}

	body {
		font-family: 'Montserrat', sans-serif;

	}

	.btn {
		flex: 1 1 auto;
		text-align: center;
		text-transform: uppercase;
		transition: 0.5s;
		background-size: 200% auto;
		color: white;
		box-shadow: 0 0 20px #eee;
		border-radius: 10px;
	}

	.btn:hover {
		background-position: right center;
		/* change the direction of the change here */
	}

	.btn-1 {
		background-image: linear-gradient(to right, #f6d365 0%, #fda085 51%, #f6d365 100%);
	}

	.btn-2 {
		background-image: linear-gradient(to right, #fbc2eb 0%, #a6c1ee 51%, #fbc2eb 100%);
	}

	.btn-3 {
		background-image: linear-gradient(to right, #84fab0 0%, #8fd3f4 51%, #84fab0 100%);
	}

	.btn-4 {
		background-image: linear-gradient(to right, #a1c4fd 0%, #c2e9fb 51%, #a1c4fd 100%);
	}

	.btn-5 {
		background-image: linear-gradient(to right, #ffecd2 0%, #fcb69f 51%, #ffecd2 100%);
	}

	.more-images {
		top: 0px;
		left: 100px;
		border-radius: 50%;
		background-color: white;
		padding: 5px;
	}

	/* Magic Stuff End -> */
</style>

<body>
	<header>
		<!-- place navbar here -->
		<div id="thongbao" th:if="${thongbao}" class="alert text-center bg-success" th:classappend="${alertClass}"
			role="alert">
			<h3 class="text-white" th:text="${thongbao}"></h3>
		</div>
	</header>
	<main class="container mt-3" style="height: 400px;">
		<div>
			<div class="main">
				<div class="tab-content" id="myTabContent">
					<div class="tab-pane fade show active" id="home-tab-pane" role="tabpanel" aria-labelledby="home-tab"
						tabindex="0">
						<div class="container-fluid">
							<div>
								<div class="row">
									<div class="col"></div>
									<div class="col-9">
										<form id="uploadForm" action="/update-user" method="post" enctype="multipart/form-data">
										    <div class="row position-relative">
										        <h3 class="nd mt-1 text-center" id="h2">Tài khoản</h3>
										        <div class="col mt-3">
										            <!-- Hình ảnh đại diện -->
										            <img id="profileImage"
										                 th:src="@{'/images/' + ${account?.getImage()}}"
										                 style="border-radius: 50%; width: 100px; height: 100px;"
										                 alt="Profile Image"
										                 onclick="document.getElementById('imageInput').click();">
										            
										            <!-- Input file ẩn để chọn ảnh mới -->
										            <input type="file" name="image" id="imageInput" style="display: none;"
										                   accept="image/*">
										            
										            <!-- Input hidden để lưu ID của tài khoản -->
										            <input type="hidden" name="id" th:value="${account.id}">
										            
										            <!-- Tên tài khoản (disabled với giá trị ID) -->
										            <h3>Tên tài khoản</h3>
										            <input class="rounded" disabled th:value="${account?.id}"
										                   type="text" style="width: 60vh" placeholder="ID">
										            <input th:value="${account?.id}" type="hidden" name="id">
										            
										            <!-- Họ và tên -->
										            <h3>Họ và tên</h3>
										            <input class="rounded" th:value="${account?.fullname}" type="text"
										                   style="width: 60vh" name="fullname" placeholder="fullname">
										            <small class="text-danger" th:text="${hoten}"></small>
										            
										            <!-- Số điện thoại -->
										            <h3>Số điện thoại</h3>
										            <input class="rounded" th:value="${account?.phone}" type="text"
										                   style="width: 60vh" name="phone" placeholder="phone">
										            <small class="text-danger" th:text="${sdt}"></small>
										            
										            <!-- Email -->
										            <h3>Email</h3>
										            <input class="rounded" type="email"
										                   style="border-radius: 5px; width: 60vh" name="email"
										                   placeholder="email" th:value="${account?.email}">
										            <small class="text-danger" th:text="${email}"></small>
										            
										            <!-- Địa chỉ -->
										            <h3>Địa chỉ</h3>
										            <textarea class="rounded" th:text="${account?.address}" type="text"
										                      style="width: 60vh; background-color: rgba(171, 177, 181, 0.205);"
										                      name="address" placeholder="address"></textarea>
										            <small class="text-danger" th:text="${diachi}"></small>
										        </div>
										    </div>
										    <div class="row">
										        <div class="col d-inline mt-3 mb-3">
										            <!-- Nút cập nhật tài khoản -->
										            <button type="submit" class="btn btn-1">Cập nhật tài khoản</button>
										            <!-- Link đổi mật khẩu (chưa được implement) -->
										            <a class="btn btn-2">Đổi mật khẩu</a>
										        </div>
										    </div>
										</form>
									</div>
									<div class="col"></div>

									<hr>
									<!-- bảng -->
									<div class="col">
										<table class="table mt-4 table table-hover table table-sm table-bordered">
											<thead>
												<tr>
													<th>STT</th>
													<th style="width: 210px;" class="text-center">Hình ảnh</th>
													<th>Tổng tiền</th>
													<th>Ngày mua</th>
													<th class="text-center">Hành động</th>
												</tr>
											</thead>
											<tbody class="table-group-divider" th:each="item,index:${bills}">
												<tr class="align-middle">
													<td th:text="${index.index + 1}">1</td>
													<td scope="row" class="text-center">
														<div class="text-nowrap">
															<div class="image-container">
																<img th:each="image, iterStat : ${item.billEntity}"
																	th:if="${iterStat.index < 3 && image.ProductEntity.imageEntities.size() > 0}"
																	th:src="@{'/images/' + ${image.ProductEntity?.imageEntities[0]?.name}}"
																	class=" rounded mx-auto ms-1 d-inline-block align-middle main-image"
																	width="50px" height="50px" alt="">
																<small th:if="${item.billEntity.size() > 3}"
																	class="align-middle more-images">
																	+<small th:text="${item.billEntity.size() - 3}">
																	</small>
																</small>
															</div>
														</div>
													</td>
													<td class="fw-bold"
														th:text="${#numbers.formatDecimal(item?.total, 1, 'COMMA', 0, 'POINT')} + ' VNĐ'">
														1</td>
													<td th:text="${#dates.format(item?.billDate, 'dd-MM-yyyy')}">1</td>
													<td class="text-center"><a th:href="'/chitiet?id='+ ${item?.id}"
															target="_parent" class="btn btn-2">Chi tiết</a></td>
												</tr>
											</tbody>
											<h3 class="text-center">HÓA ĐƠN</h3>
										</table>
										<nav class="tohop" aria-label="Page navigation example">
											<ul class="pagination" th:if="${totalPages > 10}">
												<li class="page-item" th:classappend="${currentPage == 0} ? 'disabled'">
													<a class="page-link"
														th:href="@{'/user/nguoidung?page=' + (${currentPage > 0 ? currentPage - 1 : 0}) + '&size=10'}">Previous</a>
												</li>
												<li class="page-item"
													th:each="i : ${#numbers.sequence(0, totalPages - 1)}"
													th:classappend="${i == currentPage} ? 'active'">
													<a class="page-link"
														th:href="@{'/user/nguoidung?page=' + ${i} + '&size=10'}"
														th:text="${i + 1}"></a>
												</li>
												<li class="page-item"
													th:classappend="${currentPage == totalPages - 1} ? 'disabled'">
													<a class="page-link"
														th:href="@{'/user/nguoidung?page=' + (${currentPage < totalPages - 1 ? currentPage + 1 : totalPages - 1}) + '&size=10'}">Next</a>
												</li>
											</ul>
										</nav>
									</div>

								</div>

							</div>
						</div>
					</div>

				</div>
				<div class="tab-pane fade" id="contact-tab-pane" role="tabpanel" aria-labelledby="profile-tab"
					tabindex="0">
					<div class="container-fluid">
						<div></div>
					</div>
				</div>
			</div>
		</div>
		</div>
		</div>
		</div>
	</main>
	<footer>
		<!-- place footer here -->
	</footer>
	<!-- Bootstrap JavaScript Libraries -->
	<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
		integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
		crossorigin="anonymous"></script>

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"
		integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+"
		crossorigin="anonymous"></script>
	<script>
		document.addEventListener("DOMContentLoaded", function () {
			// Find the notification element by its ID
			var notification = document.getElementById("thongbao");

			// If the notification exists, set a timeout to hide it after 3 seconds
			if (notification) {
				setTimeout(function () {
					notification.style.display = "none";
				}, 3000); // 3000ms = 3 seconds
			}
		});
		document.getElementById('profileImage').addEventListener('click', function() {
		        document.getElementById('imageInput').click();
		    });

		    // JavaScript để xử lý khi chọn ảnh mới và tự động gửi form
		    <!--document.getElementById('imageInput').addEventListener('change', function(event) {
		        const file = event.target.files[0];
		        if (file) {
		            const reader = new FileReader();
		            reader.onload = function(e) {
		                document.getElementById('profileImage').src = e.target.result;
		            };
		            reader.readAsDataURL(file);
		        }
		    });-->
	</script>
</body>

</html>